# 统一文件管理器

一个集成了本地和远程文件管理功能的Web应用程序，支持重复文件检测、目录树生成、空目录清理等实用工具。

## 功能特性

### 🔄 双模式支持
- **本地模式**: 管理本地文件系统
- **远程模式**: 通过SSH连接管理远程服务器文件

### 📁 文件管理功能
- **重复文件检测**: 比较两个目录，找出重复和相似的文件
- **批量删除**: 支持批量删除重复文件
- **目录浏览**: 可视化文件浏览器，支持导航和选择

### 🛠 本地工具集
- **目录树生成**: 生成项目目录结构树，支持.gitignore过滤
- **空目录清理**: 自动检测并删除空目录
- **Shell脚本集成**: 集成了tree.sh和interactive_delete_empty_dirs.sh

### 🌐 远程管理
- **SSH连接**: 安全连接到远程Linux/Unix服务器
- **远程文件操作**: 远程目录比较、文件删除等操作

## 快速开始

### 安装依赖

```bash
# 使用pip安装Python依赖
pip install -r requirements.txt
```

### 启动应用

#### Windows用户
```bash
run_ssh_manager.bat
```

#### Linux/Mac用户
```bash
chmod +x run_ssh_manager.sh
./run_ssh_manager.sh
```

#### 手动启动
```bash
python ssh_file_manager.py
```

### 访问应用

打开浏览器访问: http://localhost:5000

## 使用指南

### 模式切换

应用启动后，你会看到右上角的模式切换按钮：
- **本地模式**: 管理本机文件系统
- **远程模式**: 管理远程SSH服务器文件

### 本地模式功能

#### 1. 目录树生成
- 输入目录路径（默认为当前目录）
- 选择是否应用.gitignore规则
- 选择是否仅显示目录
- 设置显示层级限制
- 点击"生成目录树"查看结果

#### 2. 空目录清理
- 输入要清理的目录路径
- 点击"清理空目录"
- 确认操作后自动删除所有空目录

#### 3. 目录比较
- 输入两个本地目录路径
- 设置文件名相似度阈值
- 点击"比较"查看重复文件
- 支持批量删除重复文件

### 远程模式功能

#### 1. SSH连接
- 填写服务器地址、用户名、密码和端口
- 点击"连接"建立SSH连接
- 连接成功后可进行远程文件操作

#### 2. 远程目录比较
- 连接成功后，输入两个远程目录路径
- 使用目录浏览器选择路径
- 比较和删除重复文件

## 项目结构

```
script-collection/
├── ssh_file_manager.py          # 主应用程序
├── run_ssh_manager.bat          # Windows启动脚本
├── run_ssh_manager.sh           # Linux/Mac启动脚本
├── requirements.txt             # Python依赖
├── tree.sh                      # 目录树生成脚本
├── interactive_delete_empty_dirs.sh  # 交互式空目录删除脚本
├── templates/
│   └── index.html              # Web界面模板
├── static/                     # 静态资源（如果有）
└── README.md                   # 项目说明
```

## 主要组件

### FileManager类
- `set_mode(mode)`: 设置工作模式（local/remote）
- `connect()`: SSH连接管理
- `list_directory()`: 目录列表获取
- `compare_directories()`: 目录比较算法
- `delete_file_or_dir()`: 文件/目录删除
- `run_tree_command()`: 目录树生成
- `clean_empty_directories()`: 空目录清理

### Web接口
- `/set_mode`: 模式切换
- `/connect`: SSH连接
- `/compare`: 目录比较
- `/delete`: 文件删除
- `/tree`: 目录树生成
- `/clean_empty_dirs`: 空目录清理
- `/browse`: 目录浏览

## 安全注意事项

1. **SSH密码**: 应用不会存储SSH密码，仅在会话期间保持连接
2. **文件删除**: 所有删除操作都是不可逆的，请谨慎操作
3. **权限控制**: 确保运行用户有足够权限访问目标目录
4. **网络安全**: 建议在可信网络环境中使用

## 故障排除

### 常见问题

1. **SSH连接失败**
   - 检查网络连接
   - 验证服务器地址、用户名和密码
   - 确认SSH服务运行正常

2. **权限错误**
   - 确保用户有目录访问权限
   - 检查文件/目录权限设置

3. **脚本执行失败**
   - 确认bash环境可用（Linux/Mac）
   - 检查tree.sh脚本权限

### 日志查看

应用在控制台输出详细日志，包括：
- 连接状态
- 操作结果
- 错误信息

## 开发和扩展

### 添加新功能

1. 在FileManager类中添加新方法
2. 在Flask应用中添加相应路由
3. 在HTML模板中添加用户界面
4. 更新JavaScript处理逻辑

### 自定义配置

可以修改以下参数：
- 服务器端口（默认5000）
- 相似度阈值范围
- 目录树显示选项
- UI样式和布局

## 许可证

此项目遵循开源许可证，具体条款请查看LICENSE文件。

## 贡献

欢迎提交问题报告和功能请求！如果你想贡献代码：

1. Fork此仓库
2. 创建特性分支
3. 提交你的修改
4. 创建Pull Request

---

**注意**: 使用此工具时请确保你有适当的权限操作目标文件和目录，所有删除操作都是不可逆的。
